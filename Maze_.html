<!DOCTYPE html>
<html>
    <head>
        <style>
            canvas {

                margin-top: 0;
                background-color: black;
            }
        </style>
    </head>

    <body onload="drawMaze()">

        <canvas id="canvas"></canvas>

        <script>
        var width = 100; // Larghezza desiderata dell'immagine
        var height = 100; // Altezza desiderata dell'immagine
        var blockSize = 50;
        
        function drawMaze() {
            
            var canvas = document.getElementById("canvas");
            c = canvas.getContext("2d");
            
            var innerWidth = 1200, 
            innerHeight = 700;
            
            canvas.width = innerWidth;
            canvas.height = innerHeight;

            var maze = [
            [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0],
            [ 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0],
            [ 0, 0, 0, -1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0],
            [ 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0],
            [ 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0],
            [ 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0],
            [ -1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0],
            [ 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            [ 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0],
            [ 1, -1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0],
            [ 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, -2],
            [ 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0],
        ];

        
        
        //Function that creates the squares (stessa funzione usata negli altri due esempi di canvas)
        function object (x, y, width, height, color) {
            
            this.width = width;
            this.height = height;
            this.x = x;
            this.y = y;
            this.color = color;

            this.update = function() {

                this.draw();
            }

            this.draw = function () {

                c.beginPath();
                c.rect(this.x, this.y, this.width, this.height);
                c.fillStyle = this.color;
                c.fill();
                c.closePath();
            }
        }

        var wall=[], enemy=[], win=[];
        
        //We loop the maze array and rapresent the 1s as walls
        for (var y = 0; y<maze.length; y++) {
            for (var x=0; x<maze[y].length; x++) {

                if (maze[y][x] === 1) {

                    //Paint it red of 1s
                    wall.push(new object(x*blockSize, y*blockSize, blockSize, blockSize, "red"));
                }
                else if (maze[y][x] === -1) {

                    //This can rapresent the goal
                    enemy.push(new object(x*blockSize, y*blockSize, blockSize, blockSize, "blue"));
                }
                else if (maze[y][x] === -2) {

                    //This can rapresent the win
                    win.push(new object(x*blockSize, y*blockSize, blockSize, blockSize, "green"));
                }
            }
        }

        //Aggiorna e disegna tutti gli oggetti nell'array walls
        function updateWalls() {
            for (var i=0; i<wall.length; i++) {
                wall[i].update();
            }
        }
        
        //Aggiorna e disegna tutti gli oggetti nell'array enemies
        function updateEnemies() {
            for (var i=0; i<enemy.length; i++) {
                enemy[i].update();
            }
        }
        
        //Aggiorna e disegna tutti gli oggetti nell'array wins
        function updateWins() {
            for (var i=0; i<win.length; i++) {
                win[i].update();
            }
        }
        
        //Aggiorna e disegna tutto
        function update() {
            updateWalls();
            updateEnemies();
            updateWins();
        }

        //Chiamata alla funzione di aggiornamento
        update();

        var xImage = -20,
            yImage = -20;

        var image = new Image();
        image.src = 'LanzafameMarco_PallaLabirinto.png';

        image.onload = function() {

            c.drawImage(image, xImage, yImage, width, height);
        }

        }

        // Set initial position of the character
        var player = {
        x: 0,
        y: 0
        };

        // Handle arrow key presses
        document.addEventListener("keydown", function(event) {
        switch (event.key) {
            case "ArrowUp":
            player.y -= 10;
            break;
            case "ArrowDown":
            player.y += 10;
            break;
            case "ArrowLeft":
            player.x -= 10;
            break;
            case "ArrowRight":
            player.x += 10;
            break;
        }

        // Redraw the maze and player
        drawMaze();
        drawPlayer();
        });

        // Draw the player at its current position
        function drawPlayer() {
            c.clearRect(player.x, player.y, 70, 70);
            c.drawImage(image, player.x, player.y, width, height);
        }

        // Call the function to draw the maze and player
        drawMaze();
        drawPlayer();


        </script>
    </body>
</html>